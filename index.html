<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>moba.gg</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', system-ui, sans-serif; }
  </style>
</head>
<body class="bg-white min-h-screen flex flex-col">
  <!-- Header -->
  <header class="w-full bg-indigo-500 text-white py-4 shadow-md mb-8">
    <div class="container mx-auto flex justify-center">
      <span class="text-2xl font-bold tracking-tight">moba.gg</span>
    </div>
  </header>

  <!-- Main Content -->
  <main class="flex-grow container mx-auto px-4">
    <h1 class="text-3xl font-bold text-indigo-700 mb-8 text-center">Tier List - Mobile Legends</h1>
    <div class="flex flex-wrap justify-center gap-4 mb-5">
      <label for="rank" class="font-medium text-gray-700">Rank:</label>
      <select id="rank" class="rounded-lg border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-indigo-400 focus:border-indigo-300 transition">
        <option value="mythic">Mythic</option>
        <option value="legend">Legend</option>
        <option value="epic">Epic</option>
        <option value="grandmaster">Grandmaster</option>
        <option value="master">Master</option>
        <option value="elite">Elite</option>
        <option value="warrior">Warrior</option>
      </select>
      <label for="days" class="font-medium text-gray-700">Dias:</label>
      <select id="days" class="rounded-lg border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-indigo-400 focus:border-indigo-300 transition">
        <option value="1">1</option>
        <option value="3">3</option>
        <option value="7" selected>7</option>
        <option value="15">15</option>
        <option value="30">30</option>
      </select>
    </div>
    <div id="filter-section" class="mb-8 flex flex-wrap justify-center items-center gap-5 bg-gray-50 p-5 rounded-xl shadow">
      <h2 class="font-semibold text-indigo-500 text-base mb-0">Filtrar por Função e Rota</h2>
      <label for="role" class="font-medium text-gray-700">Função:</label>
      <select id="role" class="rounded-lg border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-indigo-400 focus:border-indigo-300 transition">
        <option value="">Todas</option>
        <option value="mage">Mage</option>
        <option value="marksman">Marksman</option>
        <option value="tank">Tank</option>
        <option value="assassin">Assassin</option>
        <option value="fighter">Fighter</option>
        <option value="support">Support</option>
      </select>
      <label for="lane" class="font-medium text-gray-700">Rota:</label>
      <select id="lane" class="rounded-lg border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-indigo-400 focus:border-indigo-300 transition">
        <option value="">Todas</option>
        <option value="mid">Mid</option>
        <option value="gold">Gold</option>
        <option value="exp">EXP</option>
        <option value="jungle">Jungle</option>
        <option value="roam">Roam</option>
      </select>
    </div>
    <div class="tier-box tier-ss mb-8">
      <div class="tier-label ss">SS</div>
      <div id="tier-ss" class="tier-container flex flex-wrap gap-4"></div>
    </div>
    <div class="tier-box tier-s mb-8">
      <div class="tier-label s">S</div>
      <div id="tier-s" class="tier-container flex flex-wrap gap-4"></div>
    </div>
    <div class="tier-box tier-a mb-8">
      <div class="tier-label a">A</div>
      <div id="tier-a" class="tier-container flex flex-wrap gap-4"></div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="w-full bg-gray-800 text-gray-200 py-6 mt-12">
    <div class="flex flex-col items-center justify-center space-y-2">
      <div class="flex items-center space-x-2">
        <span class="font-semibold text-lg tracking-tight">Arthur Henrique</span>
        <a href="https://github.com/tutujokes" target="_blank" rel="noopener" aria-label="GitHub">
          <svg class="w-6 h-6 text-gray-200 hover:text-indigo-400 transition-colors" fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 .5C5.7.5.5 5.7.5 12c0 5.1 3.3 9.4 7.8 10.9.6.1.8-.3.8-.6v-2.2c-3.2.7-3.9-1.5-3.9-1.5-.5-1.2-1.2-1.6-1.2-1.6-1-.7.1-.7.1-.7 1.1.1 1.7 1.1 1.7 1.1 1 .1 1.7-.7 2-1.1-.8-.1-1.7-.4-2.4-.9-.5-.5-.9-1.2-.9-2.1 0-.4.1-.7.3-1-.1-.3-.4-1.1.1-2.2 0 0 .8-.2 2.6 1 .8-.2 1.6-.3 2.4-.3.8 0 1.6.1 2.4.3 1.8-1.2 2.6-1 2.6-1 .5 1.1.3 1.9.2 2.2.2.3.3.6.3 1 0 .9-.3 1.6-.9 2.1-.7.5-1.6.8-2.4.9.3.2.6.7.6 1.4v2c0 .3.2.7.8.6C20.7 21.4 24 17.1 24 12c0-6.3-5.2-11.5-12-11.5z"/>
          </svg>
        </a>
      </div>
      <div class="text-sm text-gray-400">
        moba.gg &reg; 2025
      </div>
    </div>
  </footer>

  <script>
    let heroIdToName = {};
    let heroNameToId = {};
    let heroExtraInfo = {};
    let tierCards = [];
    let tierRecords = [];

    function fetchHeroMap() {
      return fetch('https://mlbb-proxy.vercel.app/api/hero-list')
        .then(res => res.json())
        .then(map => {
          heroIdToName = map;
          heroNameToId = {};
          Object.entries(map).forEach(([id, name]) => {
            heroNameToId[name] = id;
          });
        });
    }

    function fetchAllHeroPositions() {
      return fetch('https://mlbb-proxy.vercel.app/api/hero-position?role=all&lane=all&size=127&index=1')
        .then(res => res.json())
        .then(json => {
          heroExtraInfo = {};
          (json.data.records || []).forEach(entry => {
            const heroData = entry.data;
            heroExtraInfo[String(heroData.hero_id)] = {
              role: (heroData.hero && heroData.hero.data && heroData.hero.data.sortid && heroData.hero.data.sortid.length && heroData.hero.data.sortid[0] && heroData.hero.data.sortid[0].data && heroData.hero.data.sortid[0].data.sort_title) ? heroData.hero.data.sortid[0].data.sort_title.toLowerCase() : "",
              roadsort: (heroData.hero && heroData.hero.data && heroData.hero.data.roadsort) ? heroData.hero.data.roadsort : []
            };
          });
        });
    }

    function carregarTierList() {
      const rank = document.getElementById('rank').value;
      const days = document.getElementById('days').value;
      const url = `https://mlbb-proxy.vercel.app/api/hero-rank?source=rank&days=${days}&rank=${rank}&size=130&sort_field=win_rate&sort_order=desc`;

      document.getElementById('tier-ss').innerHTML = '';
      document.getElementById('tier-s').innerHTML = '';
      document.getElementById('tier-a').innerHTML = '';
      tierCards = [];
      tierRecords = [];

      Promise.all([fetchHeroMap(), fetchAllHeroPositions(), fetch(url).then(res => res.json())])
        .then(([_, __, json]) => {
          const records = json.data.records || [];
          tierRecords = records;

          records.forEach(entry => {
            const hero = entry.data.main_hero.data;
            const winRate = (entry.data.main_hero_win_rate * 100).toFixed(1);

            const heroId = heroNameToId[hero.name];
            const info = heroExtraInfo[heroId] || {};
            const role = info.role || '';
            let roadsortTitles = [];
            let iconCount = 0;
            let roadsortHtml = '';

            if (Array.isArray(info.roadsort) && info.roadsort.length > 0) {
              roadsortTitles = info.roadsort.map(rs => (rs.data && rs.data.road_sort_title) ? rs.data.road_sort_title : '').filter(Boolean);
              iconCount = info.roadsort.length;
              roadsortHtml = info.roadsort.map(rs => {
                const data = rs.data || {};
                return data.road_sort_icon
                  ? `<span class="hero-route"><img src="${data.road_sort_icon}" alt="" title="${data.road_sort_title}"></span>`
                  : '';
              }).join('');
            } else {
              iconCount = 0;
              roadsortHtml = '';
            }

            const el = document.createElement('div');
            el.className = 'card bg-white rounded-xl shadow transition-transform duration-200 hover:-translate-y-1 hover:scale-105 hover:shadow-2xl p-3 flex flex-col items-center mb-3';
            el.setAttribute('data-role', role);
            el.setAttribute('data-routes', roadsortTitles.join('|').toLowerCase());
            el.setAttribute('data-id', heroId || '');
            el.setAttribute('data-name', hero.name);

            if (iconCount === 1) {
              el.innerHTML = `
                <img src="${hero.head}" alt="${hero.name}" class="w-16 h-16 rounded-full mb-2 object-cover border-2 border-gray-100 shadow-sm">
                <div class="hero-name text-indigo-900 font-semibold">${hero.name}</div>
                <div class="hero-meta text-gray-600 text-sm">${winRate}% WR</div>
                <div class="hero-routes single flex justify-center mt-2">${roadsortHtml}</div>
              `;
            } else if (iconCount > 1) {
              el.innerHTML = `
                <img src="${hero.head}" alt="${hero.name}" class="w-16 h-16 rounded-full mb-2 object-cover border-2 border-gray-100 shadow-sm">
                <div class="hero-name text-indigo-900 font-semibold">${hero.name}</div>
                <div class="hero-meta text-gray-600 text-sm">${winRate}% WR</div>
                <div class="hero-routes flex justify-center mt-2 gap-2">${roadsortHtml}</div>
              `;
            } else {
              el.innerHTML = `
                <img src="${hero.head}" alt="${hero.name}" class="w-16 h-16 rounded-full mb-2 object-cover border-2 border-gray-100 shadow-sm">
                <div class="hero-name text-indigo-900 font-semibold">${hero.name}</div>
                <div class="hero-meta text-gray-600 text-sm">${winRate}% WR</div>
                <div class="hero-routes flex justify-center mt-2" style="height:21px"></div>
              `;
            }

            tierCards.push(el);

            if (winRate >= 54) {
              document.getElementById('tier-ss').appendChild(el);
            } else if (winRate >= 51) {
              document.getElementById('tier-s').appendChild(el);
            } else {
              document.getElementById('tier-a').appendChild(el);
            }
          });
        })
        .catch(err => {
          console.error("Erro ao carregar tier list:", err);
        });
    }

    function filtrarTierList() {
      const role = document.getElementById('role').value.toLowerCase();
      const lane = document.getElementById('lane').value.toLowerCase();

      document.querySelectorAll('.tier-container .card').forEach(card => {
        const heroRole = (card.getAttribute('data-role') || '').toLowerCase();
        const heroRoutes = (card.getAttribute('data-routes') || '').toLowerCase();
        let mostra = true;
        if (role && !heroRole.includes(role)) mostra = false;
        if (lane && !heroRoutes.includes(lane)) mostra = false;
        card.classList.toggle('hidden', !mostra);
      });
    }

    document.addEventListener('DOMContentLoaded', function () {
      carregarTierList();

      document.getElementById('rank').addEventListener('change', carregarTierList);
      document.getElementById('days').addEventListener('change', carregarTierList);
      document.getElementById('role').addEventListener('change', filtrarTierList);
      document.getElementById('lane').addEventListener('change', filtrarTierList);
    });
  </script>
</body>
</html><!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>moba.gg</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', system-ui, sans-serif; }
  </style>
</head>
<body class="bg-white min-h-screen flex flex-col">
  <!-- Header -->
  <header class="w-full bg-indigo-500 text-white py-4 shadow-md mb-8">
    <div class="container mx-auto flex justify-center">
      <span class="text-2xl font-bold tracking-tight">moba.gg</span>
    </div>
  </header>

  <!-- Main Content -->
  <main class="flex-grow container mx-auto px-4">
    <h1 class="text-3xl font-bold text-indigo-700 mb-8 text-center">Tier List - Mobile Legends</h1>
    <div class="flex flex-wrap justify-center gap-4 mb-5">
      <label for="rank" class="font-medium text-gray-700">Rank:</label>
      <select id="rank" class="rounded-lg border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-indigo-400 focus:border-indigo-300 transition">
        <option value="mythic">Mythic</option>
        <option value="legend">Legend</option>
        <option value="epic">Epic</option>
        <option value="grandmaster">Grandmaster</option>
        <option value="master">Master</option>
        <option value="elite">Elite</option>
        <option value="warrior">Warrior</option>
      </select>
      <label for="days" class="font-medium text-gray-700">Dias:</label>
      <select id="days" class="rounded-lg border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-indigo-400 focus:border-indigo-300 transition">
        <option value="1">1</option>
        <option value="3">3</option>
        <option value="7" selected>7</option>
        <option value="15">15</option>
        <option value="30">30</option>
      </select>
    </div>
    <div id="filter-section" class="mb-8 flex flex-wrap justify-center items-center gap-5 bg-gray-50 p-5 rounded-xl shadow">
      <h2 class="font-semibold text-indigo-500 text-base mb-0">Filtrar por Função e Rota</h2>
      <label for="role" class="font-medium text-gray-700">Função:</label>
      <select id="role" class="rounded-lg border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-indigo-400 focus:border-indigo-300 transition">
        <option value="">Todas</option>
        <option value="mage">Mage</option>
        <option value="marksman">Marksman</option>
        <option value="tank">Tank</option>
        <option value="assassin">Assassin</option>
        <option value="fighter">Fighter</option>
        <option value="support">Support</option>
      </select>
      <label for="lane" class="font-medium text-gray-700">Rota:</label>
      <select id="lane" class="rounded-lg border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-indigo-400 focus:border-indigo-300 transition">
        <option value="">Todas</option>
        <option value="mid">Mid</option>
        <option value="gold">Gold</option>
        <option value="exp">EXP</option>
        <option value="jungle">Jungle</option>
        <option value="roam">Roam</option>
      </select>
    </div>
    <div class="tier-box tier-ss mb-8">
      <div class="tier-label ss">SS</div>
      <div id="tier-ss" class="tier-container flex flex-wrap gap-4"></div>
    </div>
    <div class="tier-box tier-s mb-8">
      <div class="tier-label s">S</div>
      <div id="tier-s" class="tier-container flex flex-wrap gap-4"></div>
    </div>
    <div class="tier-box tier-a mb-8">
      <div class="tier-label a">A</div>
      <div id="tier-a" class="tier-container flex flex-wrap gap-4"></div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="w-full bg-gray-800 text-gray-200 py-6 mt-12">
    <div class="flex flex-col items-center justify-center space-y-2">
      <div class="flex items-center space-x-2">
        <span class="font-semibold text-lg tracking-tight">Arthur Henrique</span>
        <a href="https://github.com/tutujokes" target="_blank" rel="noopener" aria-label="GitHub">
          <svg class="w-6 h-6 text-gray-200 hover:text-indigo-400 transition-colors" fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 .5C5.7.5.5 5.7.5 12c0 5.1 3.3 9.4 7.8 10.9.6.1.8-.3.8-.6v-2.2c-3.2.7-3.9-1.5-3.9-1.5-.5-1.2-1.2-1.6-1.2-1.6-1-.7.1-.7.1-.7 1.1.1 1.7 1.1 1.7 1.1 1 .1 1.7-.7 2-1.1-.8-.1-1.7-.4-2.4-.9-.5-.5-.9-1.2-.9-2.1 0-.4.1-.7.3-1-.1-.3-.4-1.1.1-2.2 0 0 .8-.2 2.6 1 .8-.2 1.6-.3 2.4-.3.8 0 1.6.1 2.4.3 1.8-1.2 2.6-1 2.6-1 .5 1.1.3 1.9.2 2.2.2.3.3.6.3 1 0 .9-.3 1.6-.9 2.1-.7.5-1.6.8-2.4.9.3.2.6.7.6 1.4v2c0 .3.2.7.8.6C20.7 21.4 24 17.1 24 12c0-6.3-5.2-11.5-12-11.5z"/>
          </svg>
        </a>
      </div>
      <div class="text-sm text-gray-400">
        moba.gg &reg; 2025
      </div>
    </div>
  </footer>

  <script>
    let heroIdToName = {};
    let heroNameToId = {};
    let heroExtraInfo = {};
    let tierCards = [];
    let tierRecords = [];

    function fetchHeroMap() {
      return fetch('https://mlbb-proxy.vercel.app/api/hero-list')
        .then(res => res.json())
        .then(map => {
          heroIdToName = map;
          heroNameToId = {};
          Object.entries(map).forEach(([id, name]) => {
            heroNameToId[name] = id;
          });
        });
    }

    function fetchAllHeroPositions() {
      return fetch('https://mlbb-proxy.vercel.app/api/hero-position?role=all&lane=all&size=127&index=1')
        .then(res => res.json())
        .then(json => {
          heroExtraInfo = {};
          (json.data.records || []).forEach(entry => {
            const heroData = entry.data;
            heroExtraInfo[String(heroData.hero_id)] = {
              role: (heroData.hero && heroData.hero.data && heroData.hero.data.sortid && heroData.hero.data.sortid.length && heroData.hero.data.sortid[0] && heroData.hero.data.sortid[0].data && heroData.hero.data.sortid[0].data.sort_title) ? heroData.hero.data.sortid[0].data.sort_title.toLowerCase() : "",
              roadsort: (heroData.hero && heroData.hero.data && heroData.hero.data.roadsort) ? heroData.hero.data.roadsort : []
            };
          });
        });
    }

    function carregarTierList() {
      const rank = document.getElementById('rank').value;
      const days = document.getElementById('days').value;
      const url = `https://mlbb-proxy.vercel.app/api/hero-rank?source=rank&days=${days}&rank=${rank}&size=130&sort_field=win_rate&sort_order=desc`;

      document.getElementById('tier-ss').innerHTML = '';
      document.getElementById('tier-s').innerHTML = '';
      document.getElementById('tier-a').innerHTML = '';
      tierCards = [];
      tierRecords = [];

      Promise.all([fetchHeroMap(), fetchAllHeroPositions(), fetch(url).then(res => res.json())])
        .then(([_, __, json]) => {
          const records = json.data.records || [];
          tierRecords = records;

          records.forEach(entry => {
            const hero = entry.data.main_hero.data;
            const winRate = (entry.data.main_hero_win_rate * 100).toFixed(1);

            const heroId = heroNameToId[hero.name];
            const info = heroExtraInfo[heroId] || {};
            const role = info.role || '';
            let roadsortTitles = [];
            let iconCount = 0;
            let roadsortHtml = '';

            if (Array.isArray(info.roadsort) && info.roadsort.length > 0) {
              roadsortTitles = info.roadsort.map(rs => (rs.data && rs.data.road_sort_title) ? rs.data.road_sort_title : '').filter(Boolean);
              iconCount = info.roadsort.length;
              roadsortHtml = info.roadsort.map(rs => {
                const data = rs.data || {};
                return data.road_sort_icon
                  ? `<span class="hero-route"><img src="${data.road_sort_icon}" alt="" title="${data.road_sort_title}"></span>`
                  : '';
              }).join('');
            } else {
              iconCount = 0;
              roadsortHtml = '';
            }

            const el = document.createElement('div');
            el.className = 'card bg-white rounded-xl shadow transition-transform duration-200 hover:-translate-y-1 hover:scale-105 hover:shadow-2xl p-3 flex flex-col items-center mb-3';
            el.setAttribute('data-role', role);
            el.setAttribute('data-routes', roadsortTitles.join('|').toLowerCase());
            el.setAttribute('data-id', heroId || '');
            el.setAttribute('data-name', hero.name);

            if (iconCount === 1) {
              el.innerHTML = `
                <img src="${hero.head}" alt="${hero.name}" class="w-16 h-16 rounded-full mb-2 object-cover border-2 border-gray-100 shadow-sm">
                <div class="hero-name text-indigo-900 font-semibold">${hero.name}</div>
                <div class="hero-meta text-gray-600 text-sm">${winRate}% WR</div>
                <div class="hero-routes single flex justify-center mt-2">${roadsortHtml}</div>
              `;
            } else if (iconCount > 1) {
              el.innerHTML = `
                <img src="${hero.head}" alt="${hero.name}" class="w-16 h-16 rounded-full mb-2 object-cover border-2 border-gray-100 shadow-sm">
                <div class="hero-name text-indigo-900 font-semibold">${hero.name}</div>
                <div class="hero-meta text-gray-600 text-sm">${winRate}% WR</div>
                <div class="hero-routes flex justify-center mt-2 gap-2">${roadsortHtml}</div>
              `;
            } else {
              el.innerHTML = `
                <img src="${hero.head}" alt="${hero.name}" class="w-16 h-16 rounded-full mb-2 object-cover border-2 border-gray-100 shadow-sm">
                <div class="hero-name text-indigo-900 font-semibold">${hero.name}</div>
                <div class="hero-meta text-gray-600 text-sm">${winRate}% WR</div>
                <div class="hero-routes flex justify-center mt-2" style="height:21px"></div>
              `;
            }

            tierCards.push(el);

            if (winRate >= 54) {
              document.getElementById('tier-ss').appendChild(el);
            } else if (winRate >= 51) {
              document.getElementById('tier-s').appendChild(el);
            } else {
              document.getElementById('tier-a').appendChild(el);
            }
          });
        })
        .catch(err => {
          console.error("Erro ao carregar tier list:", err);
        });
    }

    function filtrarTierList() {
      const role = document.getElementById('role').value.toLowerCase();
      const lane = document.getElementById('lane').value.toLowerCase();

      document.querySelectorAll('.tier-container .card').forEach(card => {
        const heroRole = (card.getAttribute('data-role') || '').toLowerCase();
        const heroRoutes = (card.getAttribute('data-routes') || '').toLowerCase();
        let mostra = true;
        if (role && !heroRole.includes(role)) mostra = false;
        if (lane && !heroRoutes.includes(lane)) mostra = false;
        card.classList.toggle('hidden', !mostra);
      });
    }

    document.addEventListener('DOMContentLoaded', function () {
      carregarTierList();

      document.getElementById('rank').addEventListener('change', carregarTierList);
      document.getElementById('days').addEventListener('change', carregarTierList);
      document.getElementById('role').addEventListener('change', filtrarTierList);
      document.getElementById('lane').addEventListener('change', filtrarTierList);
    });
  </script>
</body>
</html>
