<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>moba.gg</title>
  <meta name="description" content="Tier List Mobile Legends - Atualizado e filtrável por função, rota, rank e idioma.">
  <meta name="keywords" content="Mobile Legends, Tier List, MOBA, Win Rate, MLBB, Heróis">
  <meta property="og:title" content="moba.gg - Tier List Mobile Legends">
  <meta property="og:description" content="Tier list de Mobile Legends, filtrável e multilíngue.">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://mlbb-proxy.vercel.app/api/favicon.png">
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-main: #fff;
      --bg-alt: #f3f4f6;
      --text-main: #23272f;
      --text-muted: #6366f1;
      --card-bg: #fff;
      --shadow: 0 1px 8px rgba(30,40,60,0.07);
    }
    [data-theme="dark"] {
      --bg-main: #23252c;
      --bg-alt: #32343c;
      --text-main: #e4e7ef;
      --text-muted: #bfbff5;
      --card-bg: #292b33;
      --shadow: 0 2px 16px rgba(25,25,30,0.18);
    }
    html, body {
      background: var(--bg-main);
      color: var(--text-main);
      font-family: 'Inter', system-ui, sans-serif;
      transition: background 0.5s, color 0.5s;
    }
    .card, .tier-box {
      background: var(--card-bg);
      box-shadow: var(--shadow);
      transition: background 0.5s, box-shadow 0.5s;
    }
    .tier-box {
      border-radius: 14px;
      margin-bottom: 36px;
      padding: 20px 16px 10px 56px;
      position: relative;
      min-height: 120px;
      max-width: 900px;
      margin-left: auto;
      margin-right: auto;
    }
    .tier-label {
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 1.6rem;
      color: #fff;
      writing-mode: vertical-rl;
      text-orientation: mixed;
      border-radius: 14px 0 0 14px;
      text-shadow: 0 1px 12px #23272f21;
      letter-spacing: -1px;
      z-index: 10;
      background: linear-gradient(135deg, #6366f1 60%, #7e22ce 100%);
    }
    .tier-label.ss { background: linear-gradient(135deg, #6366f1 60%, #7e22ce 100%);}
    .tier-label.s { background: linear-gradient(135deg, #7e22ce 30%, #6366f1 90%);}
    .tier-label.a { background: #ffb74d; color: #23272f;}
    .tier-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 18px 24px;
      padding: 8px 0 4px 0;
      min-height: 40px;
      position: relative;
    }
    .card {
      border-radius: 12px;
      text-align: center;
      padding: 14px 10px 10px 10px;
      min-width: 138px;
      max-width: 138px;
      min-height: 175px;
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: box-shadow 0.17s, transform 0.13s, background 0.5s;
      animation: fadeInCard 0.5s cubic-bezier(.4,1.4,.5,1.01);
    }
    @keyframes fadeInCard {
      from { opacity: 0; transform: translateY(30px);}
      to { opacity: 1; transform: none;}
    }
    .card:hover {
      box-shadow: 0 8px 32px #6366f133;
      transform: translateY(-4px) scale(1.035);
    }
    .card > img[alt] {
      width: 62px;
      height: 62px;
      border-radius: 50%;
      margin-bottom: 8px;
      object-fit: cover;
      background: #232323;
      border: 2px solid var(--bg-alt);
      box-shadow: 0 1px 6px #6366f122;
    }
    .hero-name {
      font-weight: 600;
      margin-top: 4px;
      color: var(--text-main);
      font-size: 1.02rem;
      letter-spacing: -0.5px;
      line-height: 1.1;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .copy-btn {
      margin-left: 4px;
      cursor: pointer;
      background: var(--bg-alt);
      border: none;
      border-radius: 5px;
      padding: 3px 5px;
      transition: background 0.2s;
      display: inline-flex;
      align-items: center;
    }
    .copy-btn:hover, .copy-btn:focus { background: #d1d5db; }
    [data-theme="dark"] .copy-btn:hover, [data-theme="dark"] .copy-btn:focus { background: #383a43; }
    .hero-meta {
      font-size: 13px;
      color: var(--text-muted);
      font-weight: 600;
      margin-bottom: 2px;
    }
    .hero-routes {
      display: flex;
      gap: 7px;
      margin-top: 6px;
      justify-content: center;
      min-height: 21px;
    }
    .hero-routes.single { justify-content: center; }
    .hero-route img {
      width: 60px !important;
      height: 60px !important;
      border-radius: 50%;
      object-fit: cover;
      border: none !important;
      background: transparent !important;
      box-shadow: none !important;
      margin: 0 auto;
      display: block;
    }
    .hero-route span, .hero-route .route-name { display: none !important; }
    .hidden { display: none !important; }
    .footer-moba {
      background: #23272f;
      color: #b1b6c9;
      width: 100%;
      font-size: 1rem;
      min-height: 44px;
      display: flex;
      align-items: center;
      justify-content: flex-end;
      padding: 0 1.5rem;
      position: relative;
      font-family: 'Inter', system-ui, sans-serif;
      letter-spacing: 0.2px;
      transition: background 0.5s;
    }
    .footer-moba .byarthur {
      display: flex;
      align-items: center;
      gap: 3px;
      font-weight: 500;
      font-size: 1rem;
      color: #6366f1;
      margin-left: 18px;
      letter-spacing: 0.3px;
      text-decoration: none;
      transition: color 0.18s;
    }
    .footer-moba .byarthur:hover,
    .footer-moba .byarthur:focus { color: #7e22ce; }
    .footer-moba .byarthur svg {
      margin-left: 4px;
      width: 18px;
      height: 18px;
      color: #6366f1;
      stroke-width: 1.7px;
      opacity: 0.98;
      transition: color 0.2s;
    }
    .footer-moba .byarthur:hover svg,
    .footer-moba .byarthur:focus svg { color: #7e22ce; }
    .theme-switch, .lang-switch {
      cursor: pointer;
      margin: 0 0.6rem;
      border: none;
      background: transparent;
      font-size: 1.8rem;
      padding: 0.25rem;
      border-radius: 8px;
      transition: background 0.3s;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }
    .theme-switch:focus, .lang-switch:focus { outline: 2px solid #7e22ce; }
    .theme-switch:hover, .lang-switch:hover { background: #f3f4f6;}
    [data-theme="dark"] .theme-switch:hover, [data-theme="dark"] .lang-switch:hover { background: #383a43;}
    .flag-option {
      width: 28px;
      height: 20px;
      border-radius: 3px;
      margin: 0 2px;
      border: 2px solid transparent;
      cursor: pointer;
      transition: border 0.2s;
      background-size: cover;
      background-position: center;
      display: inline-block;
    }
    .flag-option.selected { border-color: #6366f1;}
    .flag-dropdown {
      display: flex;
      gap: 4px;
      background: var(--bg-alt);
      border-radius: 6px;
      padding: 7px 9px;
      position: absolute;
      top: 45px;
      left: 0;
      z-index: 40;
      box-shadow: 0 2px 12px #0002;
      border: 1px solid #e5e7eb;
      animation: fadeInCard 0.25s;
    }
    .flag-dropdown.hidden { display: none; }
    .no-results {
      color: #c026d3;
      font-weight: 600;
      background: #ffe4fe;
      border-radius: 8px;
      padding: 16px 0;
      text-align: center;
      font-size: 1.15rem;
      min-width: 200px;
      margin: 0 auto;
      margin-top: 18px;
      animation: fadeInCard 0.4s;
    }
    .select-highlight:focus, .select-highlight:active {
      outline: 2px solid #6366f1 !important;
      border-color: #6366f1 !important;
    }
    @media (max-width: 600px) {
      .tier-box { padding-left: 24px; }
      .tier-label { width: 28px; font-size: 1.1rem; padding-right: 1px;}
      .tier-container { gap: 12px 10px; }
      .card { min-width: 120px; max-width: 120px;}
      .footer-moba { font-size: 0.93rem; padding: 0 0.7rem; }
      .theme-switch, .lang-switch { font-size: 1.45rem; }
    }
    .fade-theme {
      animation: fadeTheme 0.6s;
    }
    @keyframes fadeTheme {
      from { opacity: 0.15;}
      to { opacity: 1;}
    }
  </style>
</head>
<body class="bg-white min-h-screen flex flex-col" data-theme="light">
  <!-- Header -->
  <header class="w-full bg-gradient-to-r from-indigo-500 to-purple-700 text-white py-4 shadow-md mb-8">
    <div class="container mx-auto flex justify-between items-center max-w-4xl">
      <span class="text-2xl font-bold tracking-tight select-none">moba.gg</span>
      <div class="flex items-center gap-2">
        <!-- Theme Switch -->
        <button class="theme-switch" id="themeSwitch" aria-label="Alternar modo claro/escuro" title="Modo claro/escuro">
          <span id="themeIcon" aria-hidden="true">🌙</span>
        </button>
        <!-- Language Switch -->
        <div style="position:relative;">
          <button class="lang-switch" id="langSwitch" aria-label="Trocar idioma" title="Trocar idioma">
            <span id="langFlag" aria-hidden="true" style="display:inline-block;width:28px;height:20px;border-radius:4px;vertical-align:middle;background-image:url('https://cdn.jsdelivr.net/gh/hjnilsson/country-flags/svg/br.svg');background-size:cover;background-position:center;"></span>
          </button>
          <div id="flagDropdown" class="flag-dropdown hidden">
            <span class="flag-option selected" id="flagBR" style="background-image:url('https://cdn.jsdelivr.net/gh/hjnilsson/country-flags/svg/br.svg');" title="Português (Brasil)" data-lang="pt-BR" tabindex="0" aria-label="Português"></span>
            <span class="flag-option" id="flagUS" style="background-image:url('https://cdn.jsdelivr.net/gh/hjnilsson/country-flags/svg/us.svg');" title="English (US)" data-lang="en-US" tabindex="0" aria-label="English"></span>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="flex-grow container mx-auto px-2 max-w-4xl">
    <h1 class="text-3xl font-bold text-indigo-700 mb-8 text-center" data-i18n="title">Tier List - Mobile Legends</h1>
    <div class="flex flex-wrap justify-center gap-4 mb-5">
      <label for="rank" class="font-medium text-gray-700 flex items-center" data-i18n="rank_label">Rank:</label>
      <select id="rank" class="rounded-lg border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-indigo-400 focus:border-indigo-300 transition select-highlight">
        <option value="mythic" data-i18n="rank_mythic">Mítico</option>
        <option value="legend" data-i18n="rank_legend">Lenda</option>
        <option value="epic" data-i18n="rank_epic">Épico</option>
        <option value="grandmaster" data-i18n="rank_grandmaster">Grão-mestre</option>
        <option value="master" data-i18n="rank_master">Mestre</option>
        <option value="elite" data-i18n="rank_elite">Elite</option>
        <option value="warrior" data-i18n="rank_warrior">Guerreiro</option>
      </select>
      <label for="days" class="font-medium text-gray-700 flex items-center" data-i18n="days_label">Dias:</label>
      <select id="days" class="rounded-lg border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-indigo-400 focus:border-indigo-300 transition select-highlight">
        <option value="1" data-i18n="days_1">1</option>
        <option value="3" data-i18n="days_3">3</option>
        <option value="7" selected data-i18n="days_7">7</option>
        <option value="15" data-i18n="days_15">15</option>
        <option value="30" data-i18n="days_30">30</option>
      </select>
    </div>
    <!-- Filtrar section: labels ao lado dos selects -->
    <div id="filter-section" class="mb-8 flex flex-wrap justify-center items-center gap-4 bg-gray-50 p-4 rounded-xl shadow">
      <h2 class="font-semibold text-indigo-500 text-base mb-0 mr-3" data-i18n="filter_title">Filtrar por Função e Rota</h2>
      <div class="flex items-center gap-2">
        <label for="role" class="font-medium text-gray-700" data-i18n="role_label">Função:</label>
        <select id="role" class="rounded-lg border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-indigo-400 focus:border-indigo-300 transition select-highlight">
          <option value="" data-i18n="all_roles">Todas</option>
          <option value="mage" data-i18n="role_mage">Mago</option>
          <option value="marksman" data-i18n="role_marksman">Atirador</option>
          <option value="tank" data-i18n="role_tank">Tanque</option>
          <option value="assassin" data-i18n="role_assassin">Assassino</option>
          <option value="fighter" data-i18n="role_fighter">Lutador</option>
          <option value="support" data-i18n="role_support">Suporte</option>
        </select>
      </div>
      <div class="flex items-center gap-2">
        <label for="lane" class="font-medium text-gray-700" data-i18n="lane_label">Rota:</label>
        <select id="lane" class="rounded-lg border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-indigo-400 focus:border-indigo-300 transition select-highlight">
          <option value="" data-i18n="all_lanes">Todas</option>
          <option value="mid" data-i18n="lane_mid">Meio</option>
          <option value="gold" data-i18n="lane_gold">Ouro</option>
          <option value="exp" data-i18n="lane_exp">EXP</option>
          <option value="jungle" data-i18n="lane_jungle">Selva</option>
          <option value="roam" data-i18n="lane_roam">Rotação</option>
        </select>
      </div>
    </div>
    <!-- TIER LIST BLOCKS -->
    <div class="tier-box tier-ss mb-8">
      <div class="tier-label ss">SS</div>
      <div id="tier-ss" class="tier-container"></div>
    </div>
    <div class="tier-box tier-s mb-8">
      <div class="tier-label s">S</div>
      <div id="tier-s" class="tier-container"></div>
    </div>
    <div class="tier-box tier-a mb-8">
      <div class="tier-label a">A</div>
      <div id="tier-a" class="tier-container"></div>
    </div>
    <div id="noResults" class="no-results hidden" data-i18n="no_heroes">Nenhum herói encontrado.</div>
  </main>

  <!-- Footer -->
  <footer class="footer-moba">
    <span class="text-gray-400 mr-auto font-light text-sm">moba.gg &reg; 2025</span>
    <a class="byarthur" href="https://github.com/tutujokes" target="_blank" rel="noopener" aria-label="GitHub">
      Arthur Henrique
      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" class="inline ml-1">
        <path stroke-linecap="round" stroke-linejoin="round" d="M12 2C6.48 2 2 6.48 2 12c0 4.41 2.87 8.14 6.84 9.49.5.09.66-.21.66-.47 0-.23-.01-.84-.01-1.65-2.78.6-3.37-1.34-3.37-1.34-.45-1.15-1.11-1[...]
      </svg>
    </a>
  </footer>

  <script>
    // Traduções
    const translations = {
      'pt-BR': {
        title: "Tier List - Mobile Legends",
        rank_label: "Rank:",
        rank_mythic: "Mítico",
        rank_legend: "Lenda",
        rank_epic: "Épico",
        rank_grandmaster: "Grão-mestre",
        rank_master: "Mestre",
        rank_elite: "Elite",
        rank_warrior: "Guerreiro",
        days_label: "Dias:",
        days_1: "1",
        days_3: "3",
        days_7: "7",
        days_15: "15",
        days_30: "30",
        filter_title: "Filtrar por Função e Rota",
        role_label: "Função:",
        role_mage: "Mago",
        role_marksman: "Atirador",
        role_tank: "Tanque",
        role_assassin: "Assassino",
        role_fighter: "Lutador",
        role_support: "Suporte",
        all_roles: "Todas",
        lane_label: "Rota:",
        lane_mid: "Meio",
        lane_gold: "Ouro",
        lane_exp: "EXP",
        lane_jungle: "Selva",
        lane_roam: "Rotação",
        all_lanes: "Todas",
        no_heroes: "Nenhum herói encontrado.",
        copy: "Copiar nome",
        copied: "Copiado!"
      },
      'en-US': {
        title: "Tier List - Mobile Legends",
        rank_label: "Rank:",
        rank_mythic: "Mythic",
        rank_legend: "Legend",
        rank_epic: "Epic",
        rank_grandmaster: "Grandmaster",
        rank_master: "Master",
        rank_elite: "Elite",
        rank_warrior: "Warrior",
        days_label: "Days:",
        days_1: "1",
        days_3: "3",
        days_7: "7",
        days_15: "15",
        days_30: "30",
        filter_title: "Filter by Role and Lane",
        role_label: "Role:",
        role_mage: "Mage",
        role_marksman: "Marksman",
        role_tank: "Tank",
        role_assassin: "Assassin",
        role_fighter: "Fighter",
        role_support: "Support",
        all_roles: "All",
        lane_label: "Lane:",
        lane_mid: "Mid",
        lane_gold: "Gold",
        lane_exp: "EXP",
        lane_jungle: "Jungle",
        lane_roam: "Roam",
        all_lanes: "All",
        no_heroes: "No heroes found.",
        copy: "Copy name",
        copied: "Copied!"
      }
    };

    let heroIdToName = {};
    let heroNameToId = {};
    let heroExtraInfo = {};
    let tierCards = [];
    let tierRecords = [];
    let currentLang = 'pt-BR';

    function fetchHeroMap() {
      return fetch('https://mlbb-proxy.vercel.app/api/hero-list')
        .then(res => res.json())
        .then(map => {
          heroIdToName = map;
          heroNameToId = {};
          Object.entries(map).forEach(([id, name]) => {
            heroNameToId[name] = id;
          });
        });
    }

    function fetchAllHeroPositions() {
      return fetch('https://mlbb-proxy.vercel.app/api/hero-position?role=all&lane=all&size=127&index=1')
        .then(res => res.json())
        .then(json => {
          heroExtraInfo = {};
          (json.data.records || []).forEach(entry => {
            const heroData = entry.data;
            heroExtraInfo[String(heroData.hero_id)] = {
              role: (heroData.hero && heroData.hero.data && heroData.hero.data.sortid && heroData.hero.data.sortid.length && heroData.hero.data.sortid[0] && heroData.hero.data.sortid[0].data && heroData.hero.data.sortid[0].data.role_sort_title) ? heroData.hero.data.sortid[0].data.role_sort_title : "",
              roadsort: (heroData.hero && heroData.hero.data && heroData.hero.data.roadsort) ? heroData.hero.data.roadsort : []
            };
          });
        });
    }

    function carregarTierList() {
      const rank = document.getElementById('rank').value;
      const days = document.getElementById('days').value;
      const url = `https://mlbb-proxy.vercel.app/api/hero-rank?source=rank&days=${days}&rank=${rank}&size=130&sort_field=win_rate&sort_order=desc`;

      document.getElementById('tier-ss').innerHTML = '';
      document.getElementById('tier-s').innerHTML = '';
      document.getElementById('tier-a').innerHTML = '';
      document.getElementById('noResults').classList.add('hidden');
      tierCards = [];
      tierRecords = [];

      Promise.all([fetchHeroMap(), fetchAllHeroPositions(), fetch(url).then(res => res.json())])
        .then(([_, __, json]) => {
          const records = json.data.records || [];
          tierRecords = records;
          let count = {ss:0,s:0,a:0};

          records.forEach(entry => {
            const hero = entry.data.main_hero.data;
            const winRate = (entry.data.main_hero_win_rate * 100).toFixed(1);
            const heroId = heroNameToId[hero.name];
            const info = heroExtraInfo[heroId] || {};
            let roadsortTitles = [];
            let iconCount = 0;
            let roadsortHtml = '';

            if (Array.isArray(info.roadsort) && info.roadsort.length > 0) {
              roadsortTitles = info.roadsort.map(rs =>
                (rs.data && rs.data.road_sort_title) ? rs.data.road_sort_title : ''
              ).filter(Boolean);
              iconCount = info.roadsort.length;
              roadsortHtml = info.roadsort.map(rs => {
                const data = rs.data || {};
                return data.road_sort_icon
                  ? `<span class="hero-route"><img src="${data.road_sort_icon}" alt="" title="${data.road_sort_title}"></span>`
                  : '';
              }).join('');
            }

            const el = document.createElement('div');
            el.className = 'card fade-theme';
            el.setAttribute('data-role', (info.role || '').toLowerCase());
            el.setAttribute('data-routes', roadsortTitles.join('|').toLowerCase());
            el.setAttribute('data-id', heroId || '');
            el.setAttribute('data-name', hero.name);

            // Botão copiar nome
            let copyBtn = `<button class="copy-btn" aria-label="${translate('copy')}" title="${translate('copy')}" onclick="copyHeroName(event, '${hero.name}')">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <rect x="9" y="9" width="13" height="13" rx="2" /><path d="M5 15V5a2 2 0 012-2h10"/></svg>
            </button>`;

            if (iconCount === 1) {
              el.innerHTML = `
                <img src="${hero.head}" alt="Retrato do herói ${hero.name}" loading="lazy">
                <div class="hero-name">${hero.name}${copyBtn}</div>
                <div class="hero-meta">${winRate}% WR</div>
                <div class="hero-routes single">${roadsortHtml}</div>
              `;
            } else if (iconCount > 1) {
              el.innerHTML = `
                <img src="${hero.head}" alt="Retrato do herói ${hero.name}" loading="lazy">
                <div class="hero-name">${hero.name}${copyBtn}</div>
                <div class="hero-meta">${winRate}% WR</div>
                <div class="hero-routes">${roadsortHtml}</div>
              `;
            } else {
              el.innerHTML = `
                <img src="${hero.head}" alt="Retrato do herói ${hero.name}" loading="lazy">
                <div class="hero-name">${hero.name}${copyBtn}</div>
                <div class="hero-meta">${winRate}% WR</div>
                <div class="hero-routes" style="height:21px"></div>
              `;
            }

            tierCards.push(el);

            if (winRate >= 54) {
              document.getElementById('tier-ss').appendChild(el); count.ss++;
            } else if (winRate >= 51) {
              document.getElementById('tier-s').appendChild(el); count.s++;
            } else {
              document.getElementById('tier-a').appendChild(el); count.a++;
            }
          });

          // Feedback visual se nenhum resultado
          if (!count.ss && !count.s && !count.a) {
            document.getElementById('noResults').classList.remove('hidden');
          }
        })
        .catch(err => {
          document.getElementById('noResults').classList.remove('hidden');
        });
    }

    function filtrarTierList() {
      const role = document.getElementById('role').value.toLowerCase();
      const lane = document.getElementById('lane').value.toLowerCase();
      let visible = 0;
      document.querySelectorAll('.tier-container .card').forEach(card => {
        const heroRole = (card.getAttribute('data-role') || '').toLowerCase();
        const heroRoutes = (card.getAttribute('data-routes') || '').toLowerCase();
        let mostra = true;
        if (role && !heroRole.includes(role)) mostra = false;
        if (lane && !heroRoutes.includes(lane)) mostra = false;
        card.classList.toggle('hidden', !mostra);
        if (mostra) visible++;
      });
      document.getElementById('noResults').classList.toggle('hidden', visible !== 0);
    }

    // Copiar nome do herói
    function copyHeroName(ev, name) {
      ev.stopPropagation();
      navigator.clipboard.writeText(name);
      const btn = ev.currentTarget;
      btn.setAttribute('aria-label', translate('copied'));
      btn.title = translate('copied');
      btn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="green" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
        <path d="M20 6L9 17l-5-5" /></svg>`;
      setTimeout(() => {
        btn.setAttribute('aria-label', translate('copy'));
        btn.title = translate('copy');
        btn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
          <rect x="9" y="9" width="13" height="13" rx="2" /><path d="M5 15V5a2 2 0 012-2h10"/></svg>`;
      }, 1300);
    }

    // Tradução dinâmica
    function translate(key) {
      return translations[currentLang][key] || key;
    }
    function updateI18n() {
      document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (translations[currentLang][key]) {
          el.textContent = translations[currentLang][key];
        }
      });
      // Atualizar options de selects
      document.querySelectorAll('option[data-i18n]').forEach(opt => {
        const key = opt.getAttribute('data-i18n');
        if (translations[currentLang][key]) {
          opt.textContent = translations[currentLang][key];
        }
      });
    }

    // Modo noturno
    function setTheme(theme) {
      document.body.setAttribute('data-theme', theme);
      document.body.classList.add('fade-theme');
      setTimeout(() => { document.body.classList.remove('fade-theme'); }, 600);
      // Alterar ícone do botão
      document.getElementById('themeIcon').textContent = theme === "dark" ? "☀️" : "🌙";
      localStorage.setItem('theme', theme);
    }
    function toggleTheme() {
      const newTheme = document.body.getAttribute('data-theme') === "dark" ? "light" : "dark";
      setTheme(newTheme);
    }
    // Inicialização do tema
    (function() {
      let theme = localStorage.getItem('theme');
      if (!theme) {
        theme = window.matchMedia('(prefers-color-scheme: dark)').matches ? "dark" : "light";
      }
      setTheme(theme);
    })();

    // Troca de idioma
    function showFlagDropdown(show) {
      document.getElementById('flagDropdown').classList.toggle('hidden', !show);
    }
    function setLanguage(lang) {
      currentLang = lang;
      document.documentElement.lang = lang;
      updateI18n();
      carregarTierList();
      // flags
      document.getElementById('langFlag').style.backgroundImage =
        lang === "pt-BR"
          ? "url('https://cdn.jsdelivr.net/gh/hjnilsson/country-flags/svg/br.svg')"
          : "url('https://cdn.jsdelivr.net/gh/hjnilsson/country-flags/svg/us.svg')";
      document.getElementById('flagBR').classList.toggle('selected', lang === "pt-BR");
      document.getElementById('flagUS').classList.toggle('selected', lang === "en-US");
      localStorage.setItem('lang', lang);
    }

    document.addEventListener('DOMContentLoaded', function () {
      // idioma
      let lang = localStorage.getItem('lang');
      if (!lang) lang = navigator.language === "en-US" ? "en-US" : "pt-BR";
      setLanguage(lang);

      carregarTierList();
      document.getElementById('rank').addEventListener('change', carregarTierList);
      document.getElementById('days').addEventListener('change', carregarTierList);
      document.getElementById('role').addEventListener('change', filtrarTierList);
      document.getElementById('lane').addEventListener('change', filtrarTierList);

      // Theme switch
      document.getElementById('themeSwitch').addEventListener('click', toggleTheme);

      // Language switch
      const langSwitch = document.getElementById('langSwitch');
      langSwitch.addEventListener('click', function(e) {
        showFlagDropdown(true);
        e.stopPropagation();
      });
      document.getElementById('flagBR').addEventListener('click', function() { setLanguage('pt-BR'); showFlagDropdown(false); });
      document.getElementById('flagUS').addEventListener('click', function() { setLanguage('en-US'); showFlagDropdown(false); });
      // fechar dropdown ao clicar fora
      document.addEventListener('click', function(e) {
        if (!document.getElementById('flagDropdown').contains(e.target) && e.target !== langSwitch) {
          showFlagDropdown(false);
        }
      });
      // acessibilidade: teclado
      document.getElementById('flagBR').addEventListener('keypress', function(e){ if(e.key==='Enter'){setLanguage('pt-BR');showFlagDropdown(false);} });
      document.getElementById('flagUS').addEventListener('keypress', function(e){ if(e.key==='Enter'){setLanguage('en-US');showFlagDropdown(false);} });
    });
  </script>
</body>
</html>